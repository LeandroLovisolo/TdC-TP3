
\documentclass[a4paper, 10pt, twoside]{article}

\usepackage[top=1in, bottom=1in, left=1in, right=1in]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[spanish, es-ucroman, es-noquoting]{babel}
\usepackage{setspace}
\usepackage{fancyhdr}
\usepackage{lastpage}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{verbatim}
\usepackage{graphicx}
\usepackage{float}
\usepackage{enumitem} % Provee macro \setlist
\usepackage{tabularx}
\usepackage{multirow}
\usepackage{hyperref}
\usepackage{bytefield}
\usepackage[toc, page]{appendix}


%%%%%%%%%% Configuración de Fancyhdr - Inicio %%%%%%%%%%
\pagestyle{fancy}
\thispagestyle{fancy}
\lhead{Trabajo Práctico 3 · Teoría de las Comunicaciones}
\rhead{Delgado · Lovisolo · Petaccio}
\renewcommand{\footrulewidth}{0.4pt}
\cfoot{\thepage /\pageref{LastPage}}

\fancypagestyle{caratula} {
   \fancyhf{}
   \cfoot{\thepage /\pageref{LastPage}}
   \renewcommand{\headrulewidth}{0pt}
   \renewcommand{\footrulewidth}{0pt}
}
%%%%%%%%%% Configuración de Fancyhdr - Fin %%%%%%%%%%


%%%%%%%%%% Miscelánea - Inicio %%%%%%%%%%
% Evita que el documento se estire verticalmente para ocupar el espacio vacío
% en cada página.
\raggedbottom

% Separación entre párrafos.
\setlength{\parskip}{0.5em}

% Separación entre elementos de listas.
\setlist{itemsep=0.5em}

% Asigna la traducción de la palabra 'Appendices'.
\renewcommand{\appendixtocname}{Apéndices}
\renewcommand{\appendixpagename}{Apéndices}
%%%%%%%%%% Miscelánea - Fin %%%%%%%%%%


%%%%%%%%%% Insertar gráfico - Inicio %%%%%%%%%%
\newcommand{\grafico}[3]{
  \begin{figure}[H]
    \includegraphics[type=pdf,ext=.pdf,read=.pdf]{#1}
    \caption{#2}
    \label{#3}
  \end{figure}
}
%%%%%%%%%% Insertar gráfico - Fin %%%%%%%%%%


\begin{document}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Carátula                                                                  %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\thispagestyle{caratula}

\begin{center}

\includegraphics[height=2cm]{DC.png} 
\hfill
\includegraphics[height=2cm]{UBA.jpg} 

\vspace{2cm}

Departamento de Computación,\\
Facultad de Ciencias Exactas y Naturales,\\
Universidad de Buenos Aires

\vspace{4cm}

\begin{Huge}
Trabajo Práctico 3
\end{Huge}

\vspace{0.5cm}

\begin{Large}
Teoría de las Comunicaciones
\end{Large}

\vspace{1cm}

Primer Cuatrimestre de 2014

\vspace{4cm}

\begin{tabular}{|c|c|c|}
\hline
Apellido y Nombre & LU & E-mail\\
\hline
Delgado, Alejandro N.  & 601/11 & nahueldelgado@gmail.com\\
Lovisolo, Leandro      & 645/11 & leandro@leandro.me\\
Petaccio, Lautaro José & 443/11 & lausuper@gmail.com\\
\hline
\end{tabular}

\end{center}

\newpage


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Índice                                                                    %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\tableofcontents

\newpage


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Introducción                                                              %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\section{Introducción}
\label{sec:introduccion}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Desarrollo                                                                %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\section{Desarrollo}
\label{sec:desarrollo}


\subsection{Experimentos realizados}

Pendiente.


\subsection{Problemas encontrados}


\subsection{Cambios en el código}
Realizamos modificaciones en el código original con el objetivo de arreglar ciertos problemas que encontramos en el transcurso de la experimentación y poder realizar
el registro de eventos interesantes para la experimentación.

A continuación, detallaremos los cambios realizados por archivos.

\subsubsection{cblock.py}
Se incluye a la clase PTCControlBlock el objeto max\_rcv\_wnd con el objetivo de solucionar el problema de que la recieve window incremente de tamaño. Para la solución de este problema, se modificó la función from\_in\_buffer() donde ahora se utiliza el nuevo objeto agregado haciendo que efectivamente no se incremente el tamaño de la recieve window.

Por último, modificó la función usable\_window() por el problema de que se realizaba un mal cálculo de la usable window la cual podía devolver un valor negativo.

\subsubsection{constants.py}
Se cambió el valor de MSS por 1024 ya que en redes Ethernet se obtenía un error por enviar paquetes de gran tamaño.

\subsubsection{handler.py}
Se modificó la función send\_ack() para poder realizar la experimentación sobre el protocolo. Se agregó el descarte del paquete ACK utilizando valores aleatorios generados uniformemente utilizando la biblioteca de python random y se agregó para el caso de que el paquete no sea descartado, delay para el mismo.

\subsubsection{protocol.py}
Se agregan a las funciones initialize\_threads(), start\_threads(), stop\_threads() y join\_threads() los handlers para el nuevo thread Keep Alive.

Se crea la función send\_keepalive() la cual se encarga del envío de paquetes keep alive, los cuales continen como información la receive window del emisor que luego será utilizada en el thread keep alive si es necesario.

\subsubsection{ptc\_socket.py}
El constructor de la clase Socket ahora toma los parámetros de delay y probabilida de pérdida para la realización de los experimentos. Para el mismo propósito, el objeto protocol, construido con PTCProtocol ahora se llama en su contruscción con los mismo parámetros.


\subsubsection{soquete.py}
La clase soquete percibe cambios para el registro de errores, en especial el problema en el que se aumentaba la receive window.

\subsubsection{thread.py}
Se agrega la clase KeepAliveSender que funcionará como el nuevo thread agregado para poder solucionar el problema en el que la recepción de una adviced window 0 hace que ambos, receptor y emisor queden esperando la recepción de datos. La función do\_run() de la clase es la encargada de enviar en intervalos, los paquetes keep alive para poder recibir la nueva advice window del receptor.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Resultados                                                                %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\section{Resultados}
\label{sec:resultados}

\grafico{time_vs_size}
        {Tiempo de transferencia en función del tamaño de archivo}
        {plot:time_vs_size}

\grafico{retransmissions_vs_size}
        {Retransmisiones en función del tamaño de archivo}
        {plot:retransmissions_vs_size}

\grafico{retransmissions_vs_size_wo_outliers}
        {Retransmisiones en función del tamaño de archivo, excluyendo outliers}
        {plot:retransmissions_vs_size_wo_outliers}

\grafico{time_vs_delay_and_loss_probability}
        {Tiempo de transferencia en función del retraso en envío de ACKs para distintas probabilidades de pérdida de ACKs}
        {plot:time_vs_delay_and_loss_probability}

\grafico{retransmissions_vs_delay_and_loss_probability}
        {Retransmisiones en función del retraso en envío de ACKs para distintas probabilidades de pérdida de ACKs}
        {plot:retransmissions_vs_delay_and_loss_probability}

\grafico{retransmissions_vs_delay_and_loss_probability_wo_outliers}
        {Retransmisiones en función del retraso en envío de ACKs para distintas probabilidades de pérdida de ACKs, excluyendo outliers}
        {plot:retransmissions_vs_delay_and_loss_probability_wo_outliers}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Discusión                      			                                     %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\section{Discusión}
\label{sec:discusion}


\subsection{Tiempo de transferencia en función del tamaño del archivo enviado}

Hay que decir que es lineal, como uno esperaría.


\subsection{Retransmisiones en función del tamaño de archivo enviado}

Decir que no hay correlación.


\subsection{Tiempo de transferencia en función del retraso en envío de ACKs para distintas probabilidades de pérdida de ACKs}

Decir que el tiempo disminuye a medida que la probabilidad de pérdida aumenta.


\subsection{Retransmisiones en función del retraso en envío de ACKs para distintas probabilidades de pérdida de ACKs}

Decir que no hay correlación.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Conclusión                                                                %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\section{Conclusión}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Trabajo futuro                                                            %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\section{Trabajo futuro}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Referencias                                                               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{thebibliography}{9}


\end{thebibliography}


\end{document}
